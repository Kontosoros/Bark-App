<div class="recorder-area">
    <h1>AI Bark Detection</h1>

    <div class="microphone-container">
        <button mat-icon-button class="microphone-button" (click)="toggleRecording()">
            <mat-icon [class.recording]="isRecording" class="microphone-icon">
                {{ isRecording ? 'stop' : 'hearing' }}
            </mat-icon>
        </button>
        <p class="status-text">{{ isRecording ? 'Listening for barks...' : 'Click to start listening' }}</p>
    </div>

    <!-- Loud Noise Detection Status -->
    <div class="detection-status" *ngIf="isRecording">
        <div class="status-card">
            <h3>Detection Status</h3>
            <div class="status-grid">
                <div class="status-item">
                    <span class="label">Loud Noises:</span>
                    <span class="value">{{ loudNoiseCount }}</span>
                </div>
                <div class="status-item" *ngIf="lastLoudNoise">
                    <span class="label">Last Detected:</span>
                    <span class="value">{{ lastLoudNoise | date:'HH:mm:ss' }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Samples Status -->
    <div class="audio-samples-status" *ngIf="capturedAudioSamples.length > 0">
        <div class="status-card">
            <h3>Audio Samples</h3>
            <div class="status-grid">
                <div class="status-item">
                    <span class="label">Captured:</span>
                    <span class="value">{{ capturedAudioSamples.length }}</span>
                </div>
                <div class="status-item">
                    <span class="label">Total Duration:</span>
                    <span class="value">{{ getTotalAudioDuration() | number:'1.1-1' }}s</span>
                </div>
                <div class="status-item" *ngIf="processedAudioSamples.length > 0">
                    <span class="label">Processed:</span>
                    <span class="value">{{ processedAudioSamples.length }}</span>
                </div>
            </div>
            <div class="sample-actions">
                <button mat-button color="primary" (click)="exportAudioSamples()">
                    Export JSON
                </button>
                <button mat-button color="accent" (click)="exportProcessedAudioAsWAV()" *ngIf="processedAudioSamples.length > 0">
                    Export WAV
                </button>
                <button mat-button color="warn" (click)="clearCapturedAudio()">
                    Clear All
                </button>
            </div>
        </div>
    </div>

    <app-audio-waveform></app-audio-waveform>
</div>